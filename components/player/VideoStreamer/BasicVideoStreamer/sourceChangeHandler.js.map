{"version":3,"sources":["../../../../src/replay/components/player/VideoStreamer/BasicVideoStreamer/sourceChangeHandler.js"],"names":["getSourceChangeHandler","videoElement","handleSourceChange","source","prevProps","n","streamUrl","startPosition","indexOf","src","toFixed","removeAttribute","load","Promise","resolve"],"mappings":";;;;;;;AAEA;;;;AAEe,SAASA,sBAAT,CAAgCC,YAAhC,EAAgE;AAC7E,QAAMC,kBAAkB,GAAG,CAAkC;AAAEC,IAAAA;AAAF,GAAlC,EAAiDC,SAAjD,KAAmE;AAC5F,UAAMC,CAAC,GAAG,+BAAgBF,MAAhB,CAAV;;AACA,QAAIE,CAAC,IAAIA,CAAC,CAACC,SAAX,EAAsB;AACpB,UAAI,OAAOD,CAAC,CAACE,aAAT,KAA2B,QAA3B,IAAuCF,CAAC,CAACC,SAAF,CAAYE,OAAZ,CAAoB,KAApB,IAA6B,CAAxE,EAA2E;AACzEP,QAAAA,YAAY,CAACQ,GAAb,aAAsBJ,CAAC,CAACC,SAAxB,gBAAuCD,CAAC,CAACE,aAAF,CAAgBG,OAAhB,CAAwB,CAAxB,CAAvC;AACD,OAFD,MAEO;AACLT,QAAAA,YAAY,CAACQ,GAAb,GAAmBJ,CAAC,CAACC,SAArB;AACD;AACF,KAND,MAMO,IAAIL,YAAY,CAACQ,GAAjB,EAAsB;AAC3BR,MAAAA,YAAY,CAACU,eAAb,CAA6B,KAA7B;AACAV,MAAAA,YAAY,CAACW,IAAb;AACD;;AACD,WAAOC,OAAO,CAACC,OAAR,EAAP;AACD,GAbD;;AAcA,SAAOZ,kBAAP;AACD","sourcesContent":["// @flow\nimport type { PlaybackSource } from '../types';\nimport normalizeSource from '../common/sourceNormalizer';\n\nexport default function getSourceChangeHandler(videoElement: HTMLVideoElement) {\n  const handleSourceChange = <P: { source?: ?PlaybackSource }>({ source }: P, prevProps: ?P) => {\n    const n = normalizeSource(source);\n    if (n && n.streamUrl) {\n      if (typeof n.startPosition === 'number' && n.streamUrl.indexOf('#t=') < 0) {\n        videoElement.src = `${n.streamUrl}#t=${n.startPosition.toFixed(2)}`;\n      } else {\n        videoElement.src = n.streamUrl;\n      }\n    } else if (videoElement.src) {\n      videoElement.removeAttribute('src');\n      videoElement.load();\n    }\n    return Promise.resolve();\n  };\n  return handleSourceChange;\n}\n"],"file":"sourceChangeHandler.js"}