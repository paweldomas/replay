{"version":3,"sources":["../../../../src/replay/components/player/VideoStreamer/common/propertyApplier.js"],"names":["getPropertyApplier","videoElement","streamRangeHelper","textTrackManager","audioTrackManager","bitrateManager","playbackProps","isPaused","pause","play","volume","isMuted","muted","position","setPosition","isAtLiveEdge","gotoLive","handleSelectedTextTrackChange","selectedTextTrack","selectedAudioTrack","handleSelectedAudioTrackChange","bitrateFix","undefined","fixBitrate","bitrateCap","capBitrate","isPipActive","requestPictureInPicture","webkitSetPresentationMode","document","pictureInPictureElement","exitPictureInPicture","webkitPresentationMode","isAirPlayTargetPickerVisible","webkitShowPlaybackTargetPicker"],"mappings":";;;;;;;AAIO,MAAMA,kBAAkB,GAAG,CAChCC,YADgC,EAEhCC,iBAFgC,EAGhCC,gBAHgC,EAIhCC,iBAJgC,EAKhCC,cALgC,KAM5BC,aAAD,IAAkC;AACrC,MAAI,cAAcA,aAAlB,EAAiC;AAC/B,QAAIA,aAAa,CAACC,QAAlB,EAA4B;AAC1BN,MAAAA,YAAY,CAACO,KAAb;AACD,KAFD,MAEO;AACLP,MAAAA,YAAY,CAACQ,IAAb;AACD;AACF;;AACD,MAAIH,aAAa,CAACI,MAAd,IAAwB,IAA5B,EAAkC;AAChCT,IAAAA,YAAY,CAACS,MAAb,GAAsBJ,aAAa,CAACI,MAApC;AACD;;AACD,MAAIJ,aAAa,CAACK,OAAd,IAAyB,IAA7B,EAAmC;AACjCV,IAAAA,YAAY,CAACW,KAAb,GAAqBN,aAAa,CAACK,OAAnC;AACD;;AACD,MAAIL,aAAa,CAACO,QAAd,IAA0B,IAA9B,EAAoC;AAClCX,IAAAA,iBAAiB,CAACY,WAAlB,CAA8BR,aAAa,CAACO,QAA5C;AACD;;AACD,MAAIP,aAAa,CAACS,YAAlB,EAAgC;AAC9Bb,IAAAA,iBAAiB,CAACc,QAAlB;AACD;;AACD,MAAIb,gBAAgB,IAAI,uBAAuBG,aAA/C,EAA8D;AAC5DH,IAAAA,gBAAgB,CAACc,6BAAjB,CAA+CX,aAAa,CAACY,iBAA7D;AACD;;AACD,MAAId,iBAAiB,IAAIE,aAAa,CAACa,kBAAvC,EAA2D;AACzDf,IAAAA,iBAAiB,CAACgB,8BAAlB,CAAiDd,aAAa,CAACa,kBAA/D;AACD;;AACD,MAAId,cAAJ,EAAoB;AAClB,QAAIC,aAAa,CAACe,UAAd,KAA6BC,SAAjC,EAA4C;AAC1C;AACAjB,MAAAA,cAAc,CAACkB,UAAf,CAA0BjB,aAAa,CAACe,UAAxC;AACD;;AACD,QAAIf,aAAa,CAACkB,UAAd,KAA6BF,SAAjC,EAA4C;AAC1C;AACAjB,MAAAA,cAAc,CAACoB,UAAf,CAA0BnB,aAAa,CAACkB,UAAxC;AACD;AACF,GAnCoC,CAoCrC;;;AACA,MAAI,iBAAiBlB,aAArB,EAAoC;AAClC,QAAIA,aAAa,CAACoB,WAAlB,EAA+B;AAC7B;AACA,UAAI,OAAOzB,YAAY,CAAC0B,uBAApB,KAAgD,UAApD,EAAgE;AAC9D1B,QAAAA,YAAY,CAAC0B,uBAAb,GAD8D,CAE9D;AACD,OAHD,MAGO,IAAI,OAAO1B,YAAY,CAAC2B,yBAApB,KAAkD,UAAtD,EAAkE;AACvE3B,QAAAA,YAAY,CAAC2B,yBAAb,CAAuC,oBAAvC;AACD,OAP4B,CAQ7B;;AACD,KATD,MASO,IAAIC,QAAQ,CAACC,uBAAT,KAAqC7B,YAAzC,EAAuD;AAC5D;AACA4B,MAAAA,QAAQ,CAACE,oBAAT,GAF4D,CAG5D;AACD,KAJM,MAIA,IAAI9B,YAAY,CAAC+B,sBAAb,KAAwC,oBAA5C,EAAkE;AACvE;AACA/B,MAAAA,YAAY,CAAC2B,yBAAb,CAAuC,QAAvC;AACD;AACF,GAvDoC,CAwDrC;;;AACA,MAAItB,aAAa,CAAC2B,4BAAd,IAA8C,OAAOhC,YAAY,CAACiC,8BAApB,KAAuD,UAAzG,EAAqH;AACnHjC,IAAAA,YAAY,CAACiC,8BAAb;AACD;AACF,CAlEM","sourcesContent":["// @flow\nimport type { PlaybackProps } from '../types';\nimport type { AudioTrackManager, BitrateManager, StreamRangeHelper, TextTrackManager } from './types';\n\nexport const getPropertyApplier = (\n  videoElement: HTMLVideoElement, // Abstract this away?\n  streamRangeHelper: StreamRangeHelper,\n  textTrackManager?: TextTrackManager,\n  audioTrackManager?: AudioTrackManager,\n  bitrateManager?: ?BitrateManager\n) => (playbackProps: PlaybackProps) => {\n  if ('isPaused' in playbackProps) {\n    if (playbackProps.isPaused) {\n      videoElement.pause();\n    } else {\n      videoElement.play();\n    }\n  }\n  if (playbackProps.volume != null) {\n    videoElement.volume = playbackProps.volume;\n  }\n  if (playbackProps.isMuted != null) {\n    videoElement.muted = playbackProps.isMuted;\n  }\n  if (playbackProps.position != null) {\n    streamRangeHelper.setPosition(playbackProps.position);\n  }\n  if (playbackProps.isAtLiveEdge) {\n    streamRangeHelper.gotoLive();\n  }\n  if (textTrackManager && 'selectedTextTrack' in playbackProps) {\n    textTrackManager.handleSelectedTextTrackChange(playbackProps.selectedTextTrack);\n  }\n  if (audioTrackManager && playbackProps.selectedAudioTrack) {\n    audioTrackManager.handleSelectedAudioTrackChange(playbackProps.selectedAudioTrack);\n  }\n  if (bitrateManager) {\n    if (playbackProps.bitrateFix !== undefined) {\n      // $FlowFixMe undefined is OK.\n      bitrateManager.fixBitrate(playbackProps.bitrateFix);\n    }\n    if (playbackProps.bitrateCap !== undefined) {\n      // $FlowFixMe undefined is OK.\n      bitrateManager.capBitrate(playbackProps.bitrateCap);\n    }\n  }\n  // $FlowFixMe: Type defs not up-to-date.\n  if ('isPipActive' in playbackProps) {\n    if (playbackProps.isPipActive) {\n      // $FlowFixMe\n      if (typeof videoElement.requestPictureInPicture === 'function') {\n        videoElement.requestPictureInPicture();\n        // $FlowFixMe\n      } else if (typeof videoElement.webkitSetPresentationMode === 'function') {\n        videoElement.webkitSetPresentationMode('picture-in-picture');\n      }\n      // $FlowFixMe\n    } else if (document.pictureInPictureElement === videoElement) {\n      // $FlowFixMe\n      document.exitPictureInPicture();\n      // $FlowFixMe\n    } else if (videoElement.webkitPresentationMode === 'picture-in-picture') {\n      // $FlowFixMe\n      videoElement.webkitSetPresentationMode('inline');\n    }\n  }\n  // $FlowFixMe: Type defs not up-to-date.\n  if (playbackProps.isAirPlayTargetPickerVisible && typeof videoElement.webkitShowPlaybackTargetPicker === 'function') {\n    videoElement.webkitShowPlaybackTargetPicker();\n  }\n};\n"],"file":"propertyApplier.js"}